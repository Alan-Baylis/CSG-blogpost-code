This code is:
1. Under construction.
2. Based on old messy prototype code, and therefore will probably be refactored a couple of times.
3. Not tested yet.